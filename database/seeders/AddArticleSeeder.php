<?php

namespace Database\Seeders;

use App\Models\Article;
use App\Models\User;
use Illuminate\Database\Seeder;
use Illuminate\Support\Facades\Schema;
use Illuminate\Support\Facades\Storage;
use Illuminate\Support\Str;
use Illuminate\Support\Carbon;

class AddArticleSeeder extends Seeder
{
    public function run(): void
    {
        // ‡∏´‡∏≤ author_id: ‡πÄ‡∏≠‡∏≤ User ‡πÅ‡∏£‡∏Å (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ role admin/staff ‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡∏Å‡πá‡πÑ‡∏î‡πâ ‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)
        $authorId = optional(User::query()->orderBy('id')->first())->id;

        // ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÄ‡∏Å‡πá‡∏ö‡∏†‡∏≤‡∏û‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
        // ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ß‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏†‡∏≤‡∏û‡πÑ‡∏ß‡πâ‡∏ó‡∏µ‡πà: storage/app/public/articles/xxx.jpg (‡πÅ‡∏•‡πâ‡∏ß‡∏£‡∏±‡∏ô storage:link)
        $disk = Storage::disk('public');
        if (!$disk->exists('articles')) {
            $disk->makeDirectory('articles');
        }

        // ====== ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏ö‡∏ö‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏≠‡∏á ======
        $items = [
            [
                'title'        => '‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡πÄ‡∏õ‡∏¥‡∏î‡∏ï‡∏±‡∏ß iHaveGPU ‚Äî ‡∏°‡∏¥‡∏ô‡∏¥‡∏≠‡∏µ‡∏Ñ‡∏≠‡∏°‡πÄ‡∏°‡∏¥‡∏£‡πå‡∏ã‡∏Ç‡∏≤‡∏¢‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏Ñ‡∏≠‡∏°',
                'excerpt'      => '‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡πá‡∏Å‡∏ï‡πå‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á Laravel + Breeze + Sail ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ç‡∏≤‡∏¢‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå ‡πÅ‡∏•‡∏∞‡∏ä‡∏∏‡∏î‡∏Ñ‡∏≠‡∏°‡∏û‡πå‡∏Ñ‡∏£‡∏ö‡∏ä‡∏∏‡∏î',
                'body'         => <<<MD
‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡∏™‡∏π‡πà **iHaveGPU** üéâ

‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡πá‡∏Å‡∏ï‡πå‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏°‡∏¥‡∏ô‡∏¥‡∏≠‡∏µ‡∏Ñ‡∏≠‡∏°‡πÄ‡∏°‡∏¥‡∏£‡πå‡∏ã‡∏ó‡∏µ‡πà‡∏™‡∏≤‡∏ò‡∏¥‡∏ï‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ñ‡∏£‡∏ö‡∏ß‡∏á‡∏à‡∏£:
- ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤/‡∏™‡∏ï‡πá‡∏≠‡∏Å/‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà/‡πÅ‡∏ö‡∏£‡∏ô‡∏î‡πå
- ‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡πÅ‡∏•‡∏∞‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠
- ‡∏ä‡∏∏‡∏î‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå (Computer Set)
- ‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏°/‡∏Ç‡πà‡∏≤‡∏ß (Articles)

‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏ö‡∏ó‡∏ö‡∏≤‡∏ó **Admin / Staff / Customer** ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á UI ‡∏î‡πâ‡∏ß‡∏¢ Breeze + TailwindCSS
MD,
                'cover_image'  => null, // ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: 'articles/cover-ihavegpu.jpg'
                'is_published' => true,
                'published_at' => now()->subDays(3),
            ],
            [
                'title'        => 'Tips ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å PSU ‡πÉ‡∏´‡πâ‡∏û‡∏≠‡πÅ‡∏ö‡∏ö‡πÑ‡∏°‡πà‡∏á‡∏á: 80+ ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£?',
                'excerpt'      => '‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏™‡∏±‡πâ‡∏ô ‡πÜ ‡∏ß‡πà‡∏≤ 80 Plus (White/Bronze/Silver/Gold/Platinum/Titanium) ‡∏ï‡πà‡∏≤‡∏á‡∏Å‡∏±‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£ ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏µ‡πà‡∏ß‡∏±‡∏ï‡∏ï‡πå',
                'body'         => <<<MD
‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å **PSU** ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏î‡∏π‡πÅ‡∏Ñ‡πà‡∏ß‡∏±‡∏ï‡∏ï‡πå‡∏£‡∏ß‡∏° ‡πÅ‡∏ï‡πà‡∏Ñ‡∏ß‡∏£‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡πÇ‡∏´‡∏•‡∏î‡∏à‡∏£‡∏¥‡∏á‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö ‡πÅ‡∏•‡∏∞‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô **80 Plus** ‡∏ó‡∏µ‡πà‡∏ö‡∏≠‡∏Å‡∏ñ‡∏∂‡∏á‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡πÅ‡∏õ‡∏•‡∏á‡πÑ‡∏ü

‡∏™‡∏£‡∏∏‡∏õ‡πÄ‡∏£‡πá‡∏ß ‡πÜ:
- ‡πÄ‡∏Å‡∏°‡∏°‡∏¥‡πà‡∏á‡∏û‡∏µ‡∏ã‡∏µ‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ: 650‚Äì850W 80+ Bronze/Gold ‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠
- ‡πÉ‡∏™‡πà‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏à‡∏≠‡πÅ‡∏£‡∏á/‡∏ã‡∏µ‡∏û‡∏µ‡∏¢‡∏π OC: 850‚Äì1000W 80+ Gold/Platinum
- ‡πÄ‡∏ß‡∏¥‡∏£‡πå‡∏Ñ‡∏™‡πÄ‡∏ï‡∏ä‡∏±‡∏ô/‡∏´‡∏•‡∏≤‡∏¢ GPU: 1000W+ ‡πÅ‡∏•‡∏∞‡πÄ‡∏ô‡πâ‡∏ô‡∏£‡∏≤‡∏á 12V ‡πÄ‡∏™‡∏ñ‡∏µ‡∏¢‡∏£

‡∏≠‡∏¢‡πà‡∏≤‡∏•‡∏∑‡∏°‡∏î‡∏π‡∏´‡∏±‡∏ß‡∏ï‡πà‡∏≠ **PCIe/12VHPWR** ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏ú‡∏π‡πâ‡∏ú‡∏•‡∏¥‡∏ï‡∏î‡πâ‡∏ß‡∏¢‡∏ô‡∏∞
MD,
                'cover_image'  => null,
                'is_published' => true,
                'published_at' => now()->subDays(2),
            ],
            [
                'title'        => 'Q&A: ‡∏à‡∏≠ QD-OLED vs IPS ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏á‡∏≤‡∏ô‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö/‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏Å‡∏°',
                'excerpt'      => '‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Ç‡πâ‡∏≠‡∏î‡∏µ-‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏µ‡∏¢‡∏Ç‡∏≠‡∏á QD-OLED ‡∏Å‡∏±‡∏ö IPS ‡∏ó‡∏±‡πâ‡∏á‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏™‡∏µ ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏ß‡πà‡∏≤‡∏á ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÑ‡∏ß‡∏ï‡∏≠‡∏ö‡∏™‡∏ô‡∏≠‡∏á ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á burn-in',
                'body'         => <<<MD
**QD-OLED** ‡πÄ‡∏î‡πà‡∏ô‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ñ‡∏≠‡∏ô‡∏ó‡∏£‡∏≤‡∏™‡∏ï‡πå‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡∏ï‡∏≠‡∏ö‡∏™‡∏ô‡∏≠‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏£‡πá‡∏ß‡∏°‡∏≤‡∏Å ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö‡∏á‡∏≤‡∏ô‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏ó‡∏ô‡∏ï‡πå/‡πÄ‡∏Å‡∏°‡∏†‡∏≤‡∏û‡∏™‡∏ß‡∏¢
**IPS** ‡πÄ‡∏î‡πà‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏ß‡πà‡∏≤‡∏á‡∏™‡∏π‡∏á ‡∏£‡∏≤‡∏Ñ‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏á‡πà‡∏≤‡∏¢ ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏±‡∏á‡∏ß‡∏•‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á burn-in ‡∏°‡∏≤‡∏Å‡πÄ‡∏ó‡πà‡∏≤ OLED

‡∏ó‡∏≤‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å:
- ‡πÄ‡∏Å‡∏°‡∏ã‡∏µ‡πÄ‡∏£‡∏µ‡∏¢‡∏™ + ‡∏†‡∏≤‡∏û‡∏™‡∏ß‡∏¢: QD-OLED 240‚Äì500Hz
- ‡∏á‡∏≤‡∏ô‡∏≠‡∏≠‡∏ü‡∏ü‡∏¥‡∏®/‡πÅ‡∏™‡∏á‡∏à‡πâ‡∏≤: IPS 27‚Äì32" 4K 60‚Äì144Hz
- ‡∏ó‡∏≥‡∏™‡∏µ‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏±‡∏á: ‡∏î‡∏π‡∏Ñ‡πà‡∏≤ Delta E, coverage sRGB/DCI-P3/AdobeRGB ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≤‡∏•‡∏¥‡πÄ‡∏ö‡∏£‡∏ï
MD,
                'cover_image'  => null,
                'is_published' => true,
                'published_at' => now()->subDay(),
            ],
            [
                'title'        => 'Roadmap ‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡∏ñ‡∏±‡∏î‡πÑ‡∏õ‡∏Ç‡∏≠‡∏á iHaveGPU',
                'excerpt'      => '‡πÅ‡∏à‡πâ‡∏á‡πÅ‡∏ú‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå ‡πÄ‡∏ä‡πà‡∏ô ‡∏Ñ‡∏π‡∏õ‡∏≠‡∏á, wishlist, ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏™‡πÄ‡∏õ‡∏Å, export ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô',
                'body'         => <<<MD
**Roadmap (‡∏£‡∏∞‡∏¢‡∏∞‡∏™‡∏±‡πâ‡∏ô)**
- ‡∏Ñ‡∏π‡∏õ‡∏≠‡∏á‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î / ‡πÇ‡∏Ñ‡πâ‡∏î‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡∏ô
- Wishlist / ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏™‡πÄ‡∏õ‡∏Å
- Export ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ (.xlsx)
- ‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏ö‡∏ö Markdown (‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏†‡∏≤‡∏û‡πÉ‡∏ô‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤)

**‡∏£‡∏∞‡∏¢‡∏∞‡∏Å‡∏•‡∏≤‡∏á**
- ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏™‡∏ï‡πá‡∏≠‡∏Å‡πÉ‡∏Å‡∏•‡πâ‡∏´‡∏°‡∏î
- Review ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
- ‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô (mock/‡∏õ‡∏•‡∏±‡πä‡∏Å‡∏≠‡∏¥‡∏ô gateway)
MD,
                'cover_image'  => null,
                'is_published' => false, // draft
                'published_at' => null,
            ],
        ];

        foreach ($items as $item) {
            $payload = [
                'title'        => $item['title'],
                'slug'         => $this->uniqueSlug($item['title']),
                'excerpt'      => $item['excerpt'] ?? null,
                'body'         => $item['body'] ?? '',
                'cover_image'  => $item['cover_image'] ?? null,
                'is_published' => (bool) ($item['is_published'] ?? false),
                'published_at' => $item['is_published'] ? ($item['published_at'] ?? now()) : null,
                'author_id'    => $authorId,
                'created_at'   => now(),
                'updated_at'   => now(),
            ];

            // ‡∏ñ‡πâ‡∏≤‡∏ä‡∏∑‡πà‡∏≠‡∏ã‡πâ‡∏≥ ‡πÉ‡∏´‡πâ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï ‡πÅ‡∏ó‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏≠‡∏±‡∏ô‡πÉ‡∏´‡∏°‡πà (‡∏Å‡∏±‡∏ô‡∏ã‡πâ‡∏≥‡πÄ‡∏ß‡∏•‡∏≤ seed ‡∏´‡∏•‡∏≤‡∏¢‡∏£‡∏≠‡∏ö)
            Article::updateOrCreate(
                ['slug' => $payload['slug']],
                $payload
            );
        }

        // ====== ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏™‡∏∏‡πà‡∏°‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏≠‡∏µ‡∏Å 10 ‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏° (published/draft ‡∏Ñ‡∏•‡∏∞‡∏Å‡∏±‡∏ô) ======
        for ($i = 1; $i <= 10; $i++) {
            $title  = "‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà {$i}";
            $slug   = $this->uniqueSlug($title);
            $pub    = (bool) random_int(0, 1);
            $pAt    = $pub ? now()->subDays(random_int(1, 14)) : null;

            Article::updateOrCreate(
                ['slug' => $slug],
                [
                    'title'        => $title,
                    'slug'         => $slug,
                    'excerpt'      => '‡∏¢‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏£‡∏ß‡∏°‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏° (‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á)',
                    'body'         => "‡∏ô‡∏µ‡πà‡∏Ñ‡∏∑‡∏≠‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ç‡∏≠‡∏á‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç {$i}\n\n- ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤\n- ‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡∏ô‡∏õ‡∏•‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô\n- ‡∏ó‡∏£‡∏¥‡∏Ñ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÉ‡∏´‡πâ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏á‡∏≤‡∏ô",
                    'cover_image'  => null,
                    'is_published' => $pub,
                    'published_at' => $pAt,
                    'author_id'    => $authorId,
                    'created_at'   => now(),
                    'updated_at'   => now(),
                ]
            );
        }
    }

    private function uniqueSlug(string $title): string
    {
        $base = Str::slug($title) ?: 'article';
        $slug = $base;
        $i    = 1;

        while (Article::where('slug', $slug)->exists()) {
            $slug = "{$base}-{$i}";
            $i++;
        }
        return $slug;
    }
}
